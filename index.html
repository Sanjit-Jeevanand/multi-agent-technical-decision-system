<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Technical Decision System — Live Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;450;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: {
                            950: '#020617',
                            900: '#0f172a',
                            850: '#0b1221',
                            800: '#1e293b',
                            750: '#162032',
                            700: '#334155',
                        },
                        violet: {
                            400: '#a78bfa',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                        },
                        amber: {
                            450: '#f59e0b',
                        },
                        emerald: {
                            450: '#10b981',
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in': 'fadeIn 0.4s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(8px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 5px rgba(139, 92, 246, 0.2)' },
                            '100%': { boxShadow: '0 0 20px rgba(139, 92, 246, 0.4)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #020617;
            color: #e2e8f0;
            font-feature-settings: "cv02", "cv03", "cv04", "cv11";
        }
        
        .panel {
            background: rgba(15, 23, 42, 0.5);
            border: 1px solid rgba(51, 65, 85, 0.4);
            backdrop-filter: blur(12px);
        }
        
        .panel-elevated {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(139, 92, 246, 0.15);
            box-shadow: 0 0 40px -10px rgba(139, 92, 246, 0.1);
        }
        
        .agent-node {
            transition: all 0.3s ease;
        }
        
        .agent-node:hover {
            border-color: rgba(139, 92, 246, 0.4);
            transform: translateY(-2px);
        }
        
        .agent-node.active {
            border-color: rgba(139, 92, 246, 0.6);
            background: rgba(139, 92, 246, 0.1);
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.2);
        }
        
        .agent-node.running {
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        .agent-node.completed {
            border-color: rgba(16, 185, 129, 0.4);
            background: rgba(16, 185, 129, 0.05);
        }
        
        .parallel-branch {
            position: relative;
        }
        
        .parallel-branch::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            width: 8px;
            height: 1px;
            background: #334155;
        }
        
        .disagreement-card {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.02) 100%);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        
        .synthesis-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(139, 92, 246, 0.02) 100%);
            border: 1px solid rgba(139, 92, 246, 0.2);
        }
        
        .critic-card {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.03) 0%, rgba(239, 68, 68, 0.01) 100%);
            border: 1px solid rgba(239, 68, 68, 0.15);
        }
        
        .decision-trace {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            line-height: 1.6;
        }
        
        .confidence-bar {
            background: linear-gradient(90deg, #ef4444 0%, #f59e0b 50%, #10b981 100%);
            height: 4px;
            border-radius: 2px;
            position: relative;
        }
        
        .confidence-marker {
            position: absolute;
            top: -4px;
            width: 12px;
            height: 12px;
            background: white;
            border: 2px solid #8b5cf6;
            border-radius: 50%;
            transform: translateX(-50%);
            transition: left 0.5s ease;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }
        
        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .expandable-content.expanded {
            max-height: 500px;
        }
        
        .code-ref {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.65rem;
            color: #64748b;
            transition: color 0.2s;
        }
        
        .code-ref:hover {
            color: #a78bfa;
        }
        
        .workflow-connector {
            position: relative;
        }
        
        .workflow-connector::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -16px;
            width: 16px;
            height: 1px;
            background: #334155;
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 border-b border-slate-800/50 bg-slate-950/90 backdrop-blur-xl">
        <div class="max-w-[1600px] mx-auto px-6 h-14 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-7 h-7 rounded bg-violet-600 flex items-center justify-center">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                </div>
                <div>
                    <div class="font-mono text-xs font-semibold text-slate-200 tracking-wider">MULTI-AGENT SYSTEM</div>
                    <div class="text-[10px] text-slate-500 font-mono">Technical Decision Demo</div>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-900 border border-slate-700">
                    <span class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></span>
                    <span class="text-[10px] font-mono text-slate-400 uppercase tracking-wider">Graph Ready</span>
                </div>
                <a href="#" class="text-[11px] text-slate-500 hover:text-violet-400 transition-colors font-mono">Architecture</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 pt-14">
        
        <!-- Decision Prompt Section -->
        <section class="border-b border-slate-800/50 bg-slate-950/30">
            <div class="max-w-[1400px] mx-auto px-6 py-8">
                <div class="text-center mb-6">
                    <h1 class="text-2xl font-semibold text-slate-100 mb-2">Submit Technical Decision</h1>
                    <p class="text-sm text-slate-500">Multiple agents will reason independently and disagree constructively</p>
                </div>

                <!-- Decision Input -->
                <div class="max-w-3xl mx-auto">
                    <div class="relative mb-4">
                        <textarea 
                            id="decisionInput"
                            class="w-full bg-slate-950/60 border border-slate-700/50 rounded-xl p-5 pr-16 text-slate-200 placeholder-slate-600 focus:outline-none focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/30 transition-all resize-none text-base leading-relaxed min-h-[120px]"
                            placeholder="What technical decision would you like the system to analyze?"
                        ></textarea>
                        <button id="runBtn" onclick="runDecision()" class="absolute bottom-4 right-4 px-4 py-2 bg-violet-600 hover:bg-violet-500 text-white text-xs font-medium rounded-lg transition-all flex items-center gap-2">
                            <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>
                            Run Decision
                        </button>
                    </div>

                    <!-- Example Prompts -->
                    <div class="flex flex-wrap justify-center gap-2 mb-6">
                        <button onclick="setPrompt('Should we use online or batch inference for this ML system?')" class="px-3 py-1.5 rounded-full bg-slate-900 border border-slate-700 text-[11px] text-slate-400 hover:text-slate-200 hover:border-violet-500/30 transition-all">
                            Online vs batch inference
                        </button>
                        <button onclick="setPrompt('Is LangGraph justified over custom orchestration here?')" class="px-3 py-1.5 rounded-full bg-slate-900 border border-slate-700 text-[11px] text-slate-400 hover:text-slate-200 hover:border-violet-500/30 transition-all">
                            LangGraph vs custom
                        </button>
                        <button onclick="setPrompt('Should we deploy this feature behind a feature flag?')" class="px-3 py-1.5 rounded-full bg-slate-900 border border-slate-700 text-[11px] text-slate-400 hover:text-slate-200 hover:border-violet-500/30 transition-all">
                            Feature flag decision
                        </button>
                    </div>

                    <!-- Constraints -->
                    <div class="flex flex-wrap justify-center gap-4 text-[11px] text-slate-500">
                        <label class="flex items-center gap-2 cursor-pointer hover:text-slate-400">
                            <input type="checkbox" class="rounded border-slate-700 bg-slate-800 text-violet-600 focus:ring-violet-500/50">
                            <span>Latency sensitive</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:text-slate-400">
                            <input type="checkbox" class="rounded border-slate-700 bg-slate-800 text-violet-600 focus:ring-violet-500/50">
                            <span>Cost sensitive</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:text-slate-400">
                            <input type="checkbox" class="rounded border-slate-700 bg-slate-800 text-violet-600 focus:ring-violet-500/50" checked>
                            <span>High risk tolerance</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:text-slate-400">
                            <input type="checkbox" class="rounded border-slate-700 bg-slate-800 text-violet-600 focus:ring-violet-500/50">
                            <span>Small team</span>
                        </label>
                    </div>
                    <p class="text-center text-[10px] text-slate-600 mt-3">Constraints guide agent reasoning but do not force outcomes</p>
                </div>

                <!-- Execution Controls -->
                <div class="max-w-3xl mx-auto mt-6 flex items-center justify-between p-3 rounded-lg bg-slate-900/50 border border-slate-800">
                    <div class="flex items-center gap-2">
                        <button onclick="runDecision()" class="flex items-center gap-2 px-3 py-1.5 rounded bg-violet-600/20 text-violet-400 text-[11px] font-medium hover:bg-violet-600/30 transition-colors">
                            <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>
                            Run
                        </button>
                        <button class="flex items-center gap-2 px-3 py-1.5 rounded bg-slate-800 text-slate-400 text-[11px] hover:text-slate-300 transition-colors">
                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Pause
                        </button>
                        <button onclick="resetDemo()" class="flex items-center gap-2 px-3 py-1.5 rounded bg-slate-800 text-slate-400 text-[11px] hover:text-slate-300 transition-colors">
                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                            Reset
                        </button>
                    </div>
                    <div class="flex items-center gap-2 text-[10px] text-slate-500">
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                        <span>Each run produces an immutable decision trace</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Agent Workflow Graph -->
        <section class="border-b border-slate-800/50">
            <div class="max-w-[1600px] mx-auto px-6 py-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-sm font-semibold text-slate-200">Agent Execution Graph</h2>
                    <span class="text-[10px] text-slate-500 font-mono">Parallel execution enforces independent reasoning</span>
                </div>

                <div class="panel rounded-xl p-6 overflow-x-auto">
                    <div class="min-w-max flex items-center gap-4">
                        
                        <!-- Planner -->
                        <div id="agent-planner" class="agent-node w-32 p-3 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('planner')">
                            <div class="w-8 h-8 mx-auto mb-2 rounded bg-slate-800 flex items-center justify-center">
                                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                            </div>
                            <p class="text-[10px] font-medium text-slate-300">Planner</p>
                            <p class="text-[9px] text-slate-500 mt-1">Decomposes</p>
                        </div>

                        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>

                        <!-- Parallel Specialists -->
                        <div class="flex flex-col gap-2">
                            <div class="flex items-center gap-2">
                                <div id="agent-systems" class="agent-node w-28 p-2 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('systems')">
                                    <div class="w-6 h-6 mx-auto mb-1 rounded bg-slate-800 flex items-center justify-center">
                                        <svg class="w-3 h-3 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg>
                                    </div>
                                    <p class="text-[9px] font-medium text-slate-300">Systems</p>
                                </div>
                                <div id="agent-ml" class="agent-node w-28 p-2 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('ml')">
                                    <div class="w-6 h-6 mx-auto mb-1 rounded bg-slate-800 flex items-center justify-center">
                                        <svg class="w-3 h-3 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                                    </div>
                                    <p class="text-[9px] font-medium text-slate-300">ML/AI</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <div id="agent-cost" class="agent-node w-28 p-2 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('cost')">
                                    <div class="w-6 h-6 mx-auto mb-1 rounded bg-slate-800 flex items-center justify-center">
                                        <svg class="w-3 h-3 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    </div>
                                    <p class="text-[9px] font-medium text-slate-300">Cost</p>
                                </div>
                                <div id="agent-product" class="agent-node w-28 p-2 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('product')">
                                    <div class="w-6 h-6 mx-auto mb-1 rounded bg-slate-800 flex items-center justify-center">
                                        <svg class="w-3 h-3 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                                    </div>
                                    <p class="text-[9px] font-medium text-slate-300">Product</p>
                                </div>
                            </div>
                        </div>

                        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>

                        <!-- Critic -->
                        <div id="agent-critic" class="agent-node w-28 p-3 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('critic')">
                            <div class="w-8 h-8 mx-auto mb-2 rounded bg-slate-800 flex items-center justify-center">
                                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                            </div>
                            <p class="text-[10px] font-medium text-slate-300">Critic</p>
                            <p class="text-[9px] text-slate-500 mt-1">Challenges</p>
                        </div>

                        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>

                        <!-- Disagreement Detector -->
                        <div id="agent-detector" class="agent-node w-32 p-3 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('detector')">
                            <div class="w-8 h-8 mx-auto mb-2 rounded bg-slate-800 flex items-center justify-center">
                                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
                            </div>
                            <p class="text-[10px] font-medium text-slate-300">Detector</p>
                            <p class="text-[9px] text-slate-500 mt-1">Finds conflicts</p>
                        </div>

                        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>

                        <!-- Synthesizer -->
                        <div id="agent-synthesizer" class="agent-node w-32 p-3 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('synthesizer')">
                            <div class="w-8 h-8 mx-auto mb-2 rounded bg-slate-800 flex items-center justify-center">
                                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                            </div>
                            <p class="text-[10px] font-medium text-slate-300">Synthesizer</p>
                            <p class="text-[9px] text-slate-500 mt-1">Resolves</p>
                        </div>

                        <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>

                        <!-- Confidence Gate -->
                        <div id="agent-gate" class="agent-node w-28 p-3 rounded-lg border border-slate-700 bg-slate-900/50 text-center cursor-pointer" onclick="showAgentDetails('gate')">
                            <div class="w-8 h-8 mx-auto mb-2 rounded bg-slate-800 flex items-center justify-center">
                                <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            </div>
                            <p class="text-[10px] font-medium text-slate-300">Gate</p>
                            <p class="text-[9px] text-slate-500 mt-1">Validates</p>
                        </div>

                        <!-- Loopback arrow (hidden by default) -->
                        <div id="loopback" class="hidden absolute right-0 top-1/2 transform translate-x-full -translate-y-1/2">
                            <svg class="w-8 h-8 text-amber-500/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        </div>
                    </div>

                    <!-- Agent Details Panel -->
                    <div id="agentDetailsPanel" class="mt-6 p-4 rounded-lg bg-slate-950/50 border border-slate-800 hidden animate-fade-in">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <h3 class="text-sm font-semibold text-slate-200" id="agentDetailName">Systems Agent</h3>
                                <p class="text-xs text-slate-500" id="agentDetailRole">Evaluates infrastructure, scalability, and operational concerns</p>
                            </div>
                            <div class="text-right">
                                <span class="text-[10px] text-slate-500 font-mono block" id="agentDetailModel">GPT-4.1</span>
                                <span class="text-[10px] text-slate-600 font-mono" id="agentDetailTemp">temp: 0.2</span>
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="text-[10px] font-mono text-slate-500 uppercase tracking-wider mb-2">Input Schema</h4>
                                <div class="p-2 rounded bg-slate-900/80 border border-slate-800">
                                    <pre class="text-[10px] text-slate-400 overflow-x-auto" id="agentInputSchema">{
  "decision_prompt": "string",
  "constraints": ["latency", "cost"],
  "context": {...}
}</pre>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-[10px] font-mono text-slate-500 uppercase tracking-wider mb-2">Output Schema</h4>
                                <div class="p-2 rounded bg-slate-900/80 border border-slate-800">
                                    <pre class="text-[10px] text-slate-400 overflow-x-auto" id="agentOutputSchema">{
  "recommendation": "string",
  "confidence": 0.0-1.0,
  "reasoning": "string",
  "risks": ["string"]
}</pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3 flex items-center justify-between">
                            <span class="code-ref cursor-pointer hover:text-violet-400">src/agents/systems_agent.py</span>
                            <span class="text-[10px] text-slate-600">Agent executed independently</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Live Agent Outputs -->
        <div class="max-w-[1600px] mx-auto px-6 py-6 grid lg:grid-cols-2 gap-6">
            
            <!-- Agent Outputs Panel -->
            <div class="space-y-4">
                <div class="flex items-center justify-between">
                    <h2 class="text-sm font-semibold text-slate-200">Live Agent Reasoning</h2>
                    <span class="text-[10px] text-slate-500 font-mono">Updates as agents complete</span>
                </div>

                <div id="agentOutputs" class="space-y-3 max-h-[600px] overflow-y-auto">
                    <!-- Agent cards will be injected here -->
                    <div class="p-8 text-center text-slate-600 text-sm">
                        <svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                        <p>Submit a decision prompt to observe agent reasoning</p>
                    </div>
                </div>
            </div>

            <!-- Disagreement & Synthesis Panel -->
            <div class="space-y-4">
                
                <!-- Disagreement Detection -->
                <div id="disagreementPanel" class="hidden">
                    <div class="flex items-center gap-2 mb-3">
                        <svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                        <h2 class="text-sm font-semibold text-amber-400">Detected Disagreement</h2>
                    </div>
                    <p class="text-[10px] text-slate-500 mb-3">Disagreement is expected and required for defensible decisions</p>
                    
                    <div id="disagreementContent" class="disagreement-card rounded-xl p-4 space-y-3">
                        <!-- Disagreement details injected here -->
                    </div>
                </div>

                <!-- Critic Panel -->
                <div id="criticPanel" class="hidden">
                    <div class="flex items-center gap-2 mb-3">
                        <svg class="w-4 h-4 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                        <h2 class="text-sm font-semibold text-red-400">Critic Analysis</h2>
                    </div>
                    <p class="text-[10px] text-slate-500 mb-3">Critic agents do not propose solutions</p>
                    
                    <div id="criticContent" class="critic-card rounded-xl p-4 space-y-3">
                        <!-- Critic output injected here -->
                    </div>
                </div>

                <!-- Synthesis Panel -->
                <div id="synthesisPanel" class="hidden">
                    <div class="flex items-center gap-2 mb-3">
                        <svg class="w-4 h-4 text-violet-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                        <h2 class="text-sm font-semibold text-violet-400">Final Synthesis</h2>
                    </div>
                    <p class="text-[10px] text-slate-500 mb-3">Judgment occurs here — trade-offs resolved explicitly</p>
                    
                    <div id="synthesisContent" class="synthesis-card rounded-xl p-4 space-y-4">
                        <!-- Synthesis output injected here -->
                    </div>
                </div>

            </div>
        </div>

        <!-- Decision Trace & Artifacts -->
        <section class="border-t border-slate-800/50 bg-slate-950/30">
            <div class="max-w-[1600px] mx-auto px-6 py-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-sm font-semibold text-slate-200">Decision Trace & Artifacts</h2>
                    <div class="flex items-center gap-2 text-[10px] text-slate-500">
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                        <span>All artifacts are immutable after execution</span>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="flex gap-1 mb-4 border-b border-slate-800">
                    <button onclick="switchTraceTab('trace')" class="trace-tab px-4 py-2 text-[11px] font-medium text-violet-400 border-b-2 border-violet-400" data-tab="trace">Decision Trace</button>
                    <button onclick="switchTraceTab('planner')" class="trace-tab px-4 py-2 text-[11px] font-medium text-slate-500 hover:text-slate-300" data-tab="planner">Planner</button>
                    <button onclick="switchTraceTab('specialists')" class="trace-tab px-4 py-2 text-[11px] font-medium text-slate-500 hover:text-slate-300" data-tab="specialists">Specialists</button>
                    <button onclick="switchTraceTab('disagreements')" class="trace-tab px-4 py-2 text-[11px] font-medium text-slate-500 hover:text-slate-300" data-tab="disagreements">Disagreements</button>
                    <button onclick="switchTraceTab('confidence')" class="trace-tab px-4 py-2 text-[11px] font-medium text-slate-500 hover:text-slate-300" data-tab="confidence">Confidence</button>
                </div>

                <!-- Trace Content -->
                <div id="traceContent" class="panel rounded-xl p-4">
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-[10px] text-slate-500 font-mono">decisions/2026-02-05/run_0042/trace.json</span>
                        <button class="text-[10px] text-violet-400 hover:text-violet-300 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                            Download
                        </button>
                    </div>
                    <pre class="decision-trace text-slate-400 overflow-x-auto" id="traceJson">{
  "run_id": "run_0042",
  "timestamp": "2026-02-05T14:33:12Z",
  "prompt": "Should we use online or batch inference for this ML system?",
  "status": "pending",
  "agents": [],
  "synthesis": null,
  "termination": null
}</pre>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="border-t border-slate-800 py-6 px-6">
            <div class="max-w-[1600px] mx-auto flex flex-wrap justify-center gap-6 text-xs">
                <a href="#" class="code-ref hover:text-violet-400 flex items-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    src/agents/
                </a>
                <a href="#" class="code-ref hover:text-violet-400 flex items-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    src/graph/decision_graph.py
                </a>
                <a href="#" class="code-ref hover:text-violet-400 flex items-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    src/synthesis/confidence_gate.py
                </a>
            </div>
        </footer>
    </main>

    <script>
        // Agent details data
        const agentDetails = {
            planner: {
                name: 'Planner Agent',
                role: 'Decomposes complex decisions into evaluable sub-problems',
                model: 'GPT-4.1',
                temp: '0.1',
                input: `{
  "decision_prompt": "string",
  "constraints": ["string"],
  "context": {"team_size": "int", "timeline": "string"}
}`,
                output: `{
  "sub_problems": [{"dimension": "string", "query": "string"}],
  "evaluation_criteria": ["string"],
  "success_metrics": ["string"]
}`,
                code: 'src/agents/planner.py'
            },
            systems: {
                name: 'Systems Agent',
                role: 'Evaluates infrastructure, scalability, and operational concerns',
                model: 'GPT-4.1',
                temp: '0.2',
                input: `{
  "sub_problem": {"dimension": "infrastructure", "query": "string"},
  "constraints": ["latency_sensitive"],
  "current_architecture": {...}
}`,
                output: `{
  "recommendation": "online_inference",
  "confidence": 0.85,
  "reasoning": "string",
  "risks": ["cold_start_latency"],
  "alternatives": ["batch_with_caching"]
}`,
                code: 'src/agents/systems_agent.py'
            },
            ml: {
                name: 'ML/AI Agent',
                role: 'Assesses model performance, serving patterns, and ML engineering trade-offs',
                model: 'GPT-4.1',
                temp: '0.2',
                input: `{
  "sub_problem": {"dimension": "ml_serving", "query": "string"},
  "model_characteristics": {"latency_ms": "int", "batchable": "bool"}
}`,
                output: `{
  "recommendation": "batch_preference",
  "confidence": 0.72,
  "reasoning": "string",
  "risks": ["stale_predictions"],
  "alternatives": ["online_with_batch_fallback"]
}`,
                code: 'src/agents/ml_agent.py'
            },
            cost: {
                name: 'Cost & Complexity Agent',
                role: 'Analyzes cost structures, maintenance burden, and operational complexity',
                model: 'GPT-4.1',
                temp: '0.15',
                input: `{
  "sub_problem": {"dimension": "cost", "query": "string"},
  "traffic_patterns": {"qps": "int", "burstiness": "float"}
}`,
                output: `{
  "recommendation": "batch_preference",
  "confidence": 0.91,
  "reasoning": "string",
  "cost_projections": {"online_monthly": "$X", "batch_monthly": "$Y"}
}`,
                code: 'src/agents/cost_agent.py'
            },
            product: {
                name: 'Product/Risk Agent',
                role: 'Evaluates user impact, business risk, and product requirements',
                model: 'GPT-4.1',
                temp: '0.2',
                input: `{
  "sub_problem": {"dimension": "product_risk", "query": "string"},
  "stakeholder_requirements": ["real_time_dashboards"]
}`,
                output: `{
  "recommendation": "online_inference",
  "confidence": 0.68,
  "reasoning": "string",
  "risk_assessment": {"user_impact": "high", "rollback_difficulty": "medium"}
}`,
                code: 'src/agents/product_agent.py'
            },
            critic: {
                name: 'Critic Agent',
                role: 'Challenges assumptions and flags overconfidence or missing considerations',
                model: 'GPT-4.1',
                temp: '0.3',
                input: `{
  "all_recommendations": [...],
  "specialist_confidences": [...]
}`,
                output: `{
  "challenged_assumptions": ["string"],
  "overconfidence_flags": [{"agent": "string", "concern": "string"}],
  "missing_considerations": ["string"]
}`,
                code: 'src/agents/critic.py'
            },
            detector: {
                name: 'Disagreement Detector',
                role: 'Identifies and characterizes conflicts between specialist recommendations',
                model: 'GPT-4.1',
                temp: '0.1',
                input: `{
  "recommendations": [...],
  "confidences": [...]
}`,
                output: `{
  "disagreement_detected": true,
  "conflict_dimensions": ["latency_vs_cost"],
  "severity": "moderate",
  "agent_positions": {...}
}`,
                code: 'src/agents/disagreement_detector.py'
            },
            synthesizer: {
                name: 'Synthesizer Agent',
                role: 'Resolves conflicts and produces final judgment with explicit trade-offs',
                model: 'GPT-5',
                temp: '0.15',
                input: `{
  "recommendations": [...],
  "critic_analysis": {...},
  "disagreement_report": {...},
  "constraints": [...]
}`,
                output: `{
  "final_decision": "string",
  "rationale": "string",
  "rejected_alternatives": [{"option": "string", "reason": "string"}],
  "accepted_risks": ["string"],
  "confidence": 0.0-1.0
}`,
                code: 'src/agents/synthesizer.py'
            },
            gate: {
                name: 'Confidence Gate',
                role: 'Validates synthesis confidence against threshold; triggers re-execution if needed',
                model: 'Rule-based',
                temp: 'N/A',
                input: `{
  "synthesis_confidence": 0.0-1.0,
  "threshold": 0.75,
  "disagreement_severity": "string"
}`,
                output: `{
  "decision": "ACCEPT" | "REJECT" | "ITERATE",
  "action": "terminate" | "request_clarification" | "re_execute"
}`,
                code: 'src/synthesis/confidence_gate.py'
            }
        };

        // Mock decision data
        const mockDecision = {
            prompt: "Should we use online or batch inference for this ML system?",
            planner: {
                decomposition: {
                    sub_problems: [
                        { dimension: "infrastructure", query: "Can we support online serving at scale?" },
                        { dimension: "ml_serving", query: "What serving pattern suits model characteristics?" },
                        { dimension: "cost", query: "What are the cost implications?" },
                        { dimension: "product_risk", query: "What are the user and business risks?" }
                    ]
                }
            },
            specialists: [
                {
                    agent: "Systems",
                    recommendation: "online_inference",
                    confidence: 0.85,
                    reasoning: "Infrastructure supports online serving. Auto-scaling configured. Cold start risk manageable with provisioned concurrency.",
                    risks: ["cold_start_latency", "scaling_complexity"],
                    alternatives: ["batch_with_caching"]
                },
                {
                    agent: "ML/AI",
                    recommendation: "batch_preference",
                    confidence: 0.72,
                    reasoning: "Model has high initialization cost. Batch amortization significant. Predictions don't require real-time freshness.",
                    risks: ["stale_predictions", "batch_delay"],
                    alternatives: ["online_with_batch_fallback"]
                },
                {
                    agent: "Cost",
                    recommendation: "batch_preference",
                    confidence: 0.91,
                    reasoning: "Batch processing 3.2x cheaper at current scale. Reserved capacity pricing available. Online would require over-provisioning.",
                    cost_projections: { online_monthly: "$4,200", batch_monthly: "$1,310" }
                },
                {
                    agent: "Product",
                    recommendation: "online_inference",
                    confidence: 0.68,
                    reasoning: "Real-time dashboards require <100ms latency. User experience degradation unacceptable. Business risk of delayed insights high.",
                    risk_assessment: { user_impact: "high", rollback_difficulty: "medium" }
                }
            ],
            critic: {
                challenged_assumptions: [
                    "Product agent assumes real-time strictly required — verify with stakeholders",
                    "Cost agent assumes traffic pattern stable — check seasonality"
                ],
                overconfidence_flags: [
                    { agent: "Cost", concern: "91% confidence without stress-testing burst scenarios" }
                ],
                missing_considerations: [
                    "Hybrid architecture not evaluated",
                    "Caching layer implications unexplored"
                ]
            },
            disagreement: {
                detected: true,
                conflict_dimensions: ["latency_requirements", "cost_optimization"],
                severity: "moderate",
                positions: {
                    "online_preference": ["Systems", "Product"],
                    "batch_preference": ["ML/AI", "Cost"]
                }
            },
            synthesis: {
                final_decision: "hybrid_approach_with_online_default",
                rationale: "Product requirements mandate online serving for user-facing features. However, internal analytics and non-critical paths can use batch. This resolves the core disagreement: user-facing online, cost-sensitive batch.",
                rejected_alternatives: [
                    { option: "pure_batch", reason: "Violates product latency requirements; user experience impact unacceptable" },
                    { option: "pure_online", reason: "Cost 3.2x higher than necessary; misses optimization opportunity for internal use" },
                    { option: "batch_with_caching", reason: "Cache invalidation complexity; doesn't address real-time dashboard requirement" }
                ],
                accepted_risks: [
                    "Higher operational complexity managing dual paths",
                    "Potential inconsistency between online and batch predictions"
                ],
                confidence: 0.82
            },
            termination: {
                decision: "ACCEPT",
                confidence: 0.82,
                threshold: 0.75,
                iterations: 1
            }
        };

        function setPrompt(text) {
            document.getElementById('decisionInput').value = text;
            document.getElementById('decisionInput').focus();
        }

        function showAgentDetails(agentId) {
            const data = agentDetails[agentId];
            if (!data) return;
            
            const panel = document.getElementById('agentDetailsPanel');
            document.getElementById('agentDetailName').textContent = data.name;
            document.getElementById('agentDetailRole').textContent = data.role;
            document.getElementById('agentDetailModel').textContent = data.model;
            document.getElementById('agentDetailTemp').textContent = 'temp: ' + data.temp;
            document.getElementById('agentInputSchema').textContent = data.input;
            document.getElementById('agentOutputSchema').textContent = data.output;
            
            panel.classList.remove('hidden');
        }

        function runDecision() {
            const input = document.getElementById('decisionInput').value.trim();
            if (!input) {
                document.getElementById('decisionInput').focus();
                return;
            }

            // Reset UI
            resetUI();
            
            // Start execution sequence
            executeSequence();
        }

        function resetUI() {
            document.querySelectorAll('.agent-node').forEach(n => {
                n.classList.remove('active', 'running', 'completed');
            });
            document.getElementById('agentOutputs').innerHTML = '';
            document.getElementById('disagreementPanel').classList.add('hidden');
            document.getElementById('criticPanel').classList.add('hidden');
            document.getElementById('synthesisPanel').classList.add('hidden');
            document.getElementById('agentDetailsPanel').classList.add('hidden');
        }

        function resetDemo() {
            document.getElementById('decisionInput').value = '';
            resetUI();
            document.getElementById('traceJson').textContent = JSON.stringify({
                run_id: "run_0042",
                timestamp: new Date().toISOString(),
                prompt: "Pending...",
                status: "pending",
                agents: [],
                synthesis: null,
                termination: null
            }, null, 2);
        }

        async function executeSequence() {
            const prompt = document.getElementById('decisionInput').value;
            const outputsDiv = document.getElementById('agentOutputs');
            
            // Update trace
            updateTrace({ status: 'running', prompt });
            
            // Step 1: Planner
            await activateAgent('planner', 800);
            addAgentCard('planner', {
                agent: 'Planner',
                output: `Decomposed into ${mockDecision.planner.decomposition.sub_problems.length} sub-problems`,
                confidence: 0.95
            });
            
            // Step 2: Parallel Specialists
            await Promise.all([
                activateAgent('systems', 1200),
                activateAgent('ml', 1400),
                activateAgent('cost', 1000),
                activateAgent('product', 1300)
            ]);
            
            // Add specialist outputs
            mockDecision.specialists.forEach((spec, i) => {
                setTimeout(() => addAgentCard('specialist', spec), i * 200);
            });
            
            await sleep(600);
            
            // Step 3: Critic
            await activateAgent('critic', 1000);
            document.getElementById('criticPanel').classList.remove('hidden');
            document.getElementById('criticContent').innerHTML = `
                <div class="space-y-2">
                    ${mockDecision.critic.challenged_assumptions.map(a => `
                        <div class="flex items-start gap-2 text-xs text-slate-400">
                            <svg class="w-3.5 h-3.5 text-red-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                            <span>${a}</span>
                        </div>
                    `).join('')}
                    ${mockDecision.critic.overconfidence_flags.map(f => `
                        <div class="flex items-start gap-2 text-xs text-slate-400">
                            <svg class="w-3.5 h-3.5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                            <span><strong>${f.agent}:</strong> ${f.concern}</span>
                        </div>
                    `).join('')}
                </div>
            `;
            
            await sleep(400);
            
            // Step 4: Disagreement Detector
            await activateAgent('detector', 600);
            document.getElementById('disagreementPanel').classList.remove('hidden');
            document.getElementById('disagreementContent').innerHTML = `
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-[10px] text-slate-500 uppercase">Conflict Dimensions</span>
                        <span class="text-xs text-amber-400">${mockDecision.disagreement.conflict_dimensions.join(', ')}</span>
                    </div>
                    <div class="space-y-2">
                        <div class="p-2 rounded bg-slate-950/50 border border-slate-800">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-[10px] text-slate-400">Online Preference</span>
                                <span class="text-[10px] text-slate-500">${mockDecision.disagreement.positions.online_preference.join(', ')}</span>
                            </div>
                            <div class="confidence-bar w-full bg-slate-800 rounded">
                                <div class="h-full bg-gradient-to-r from-emerald-500 to-emerald-400 rounded" style="width: 76%"></div>
                            </div>
                        </div>
                        <div class="p-2 rounded bg-slate-950/50 border border-slate-800">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-[10px] text-slate-400">Batch Preference</span>
                                <span class="text-[10px] text-slate-500">${mockDecision.disagreement.positions.batch_preference.join(', ')}</span>
                            </div>
                            <div class="confidence-bar w-full bg-slate-800 rounded">
                                <div class="h-full bg-gradient-to-r from-violet-500 to-violet-400 rounded" style="width: 82%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 text-[10px] text-slate-500">
                        <span>Severity:</span>
                        <span class="px-2 py-0.5 rounded bg-amber-500/10 text-amber-400 border border-amber-500/20">${mockDecision.disagreement.severity}</span>
                    </div>
                </div>
            `;
            
            await sleep(400);
            
            // Step 5: Synthesizer
            await activateAgent('synthesizer', 1200);
            document.getElementById('synthesisPanel').classList.remove('hidden');
            document.getElementById('synthesisContent').innerHTML = `
                <div>
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-slate-200">${mockDecision.synthesis.final_decision}</h3>
                        <div class="flex items-center gap-2">
                            <span class="text-[10px] text-slate-500">Confidence</span>
                            <div class="w-24 h-1.5 bg-slate-800 rounded-full overflow-hidden">
                                <div class="h-full bg-violet-500 rounded-full" style="width: ${mockDecision.synthesis.confidence * 100}%"></div>
                            </div>
                            <span class="text-[10px] text-violet-400 font-mono">${(mockDecision.synthesis.confidence * 100).toFixed(0)}%</span>
                        </div>
                    </div>
                    <p class="text-xs text-slate-400 mb-4 leading-relaxed">${mockDecision.synthesis.rationale}</p>
                    
                    <div class="space-y-3">
                        <div>
                            <h4 class="text-[10px] font-mono text-slate-500 uppercase mb-2">Rejected Alternatives</h4>
                            <div class="space-y-2">
                                ${mockDecision.synthesis.rejected_alternatives.map(alt => `
                                    <div class="flex items-start gap-2 p-2 rounded bg-slate-950/50 border border-slate-800">
                                        <svg class="w-3.5 h-3.5 text-slate-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                                        <div>
                                            <p class="text-xs text-slate-400 font-medium">${alt.option}</p>
                                            <p class="text-[10px] text-slate-600">${alt.reason}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-[10px] font-mono text-slate-500 uppercase mb-2">Accepted Risks</h4>
                            <div class="flex flex-wrap gap-2">
                                ${mockDecision.synthesis.accepted_risks.map(risk => `
                                    <span class="px-2 py-1 rounded bg-amber-500/10 text-amber-400 text-[10px] border border-amber-500/20">${risk}</span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            await sleep(400);
            
            // Step 6: Gate
            await activateAgent('gate', 400);
            
            // Final trace update
            updateTrace({
                status: 'completed',
                prompt,
                agents: mockDecision.specialists.map(s => ({ name: s.agent, confidence: s.confidence })),
                synthesis: {
                    decision: mockDecision.synthesis.final_decision,
                    confidence: mockDecision.synthesis.confidence
                },
                termination: mockDecision.termination
            });
        }

        async function activateAgent(agentId, duration) {
            const node = document.getElementById(`agent-${agentId}`);
            if (!node) return;
            
            node.classList.add('active', 'running');
            
            await sleep(duration);
            
            node.classList.remove('running');
            node.classList.add('completed');
        }

        function addAgentCard(type, data) {
            const container = document.getElementById('agentOutputs');
            const card = document.createElement('div');
            card.className = 'animate-slide-up';
            
            if (type === 'planner') {
                card.innerHTML = `
                    <div class="p-4 rounded-xl bg-slate-900/50 border border-slate-800">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded bg-violet-900/50 flex items-center justify-center">
                                    <svg class="w-3 h-3 text-violet-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                                </div>
                                <span class="text-xs font-medium text-slate-300">Planner Agent</span>
                            </div>
                            <span class="text-[10px] text-violet-400 font-mono">GPT-4.1 • 0.95</span>
                        </div>
                        <p class="text-xs text-slate-400">${data.output}</p>
                    </div>
                `;
            } else {
                const confidenceColor = data.confidence > 0.8 ? 'text-emerald-400' : data.confidence > 0.7 ? 'text-amber-400' : 'text-slate-400';
                card.innerHTML = `
                    <div class="p-4 rounded-xl bg-slate-900/50 border border-slate-800">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded bg-slate-800 flex items-center justify-center">
                                    <svg class="w-3 h-3 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                                </div>
                                <span class="text-xs font-medium text-slate-300">${data.agent} Agent</span>
                            </div>
                            <span class="text-[10px] ${confidenceColor} font-mono">GPT-4.1 • ${data.confidence.toFixed(2)}</span>
                        </div>
                        <div class="mb-2">
                            <span class="text-[10px] text-slate-500 uppercase">Recommends</span>
                            <p class="text-sm text-slate-200 font-medium">${data.recommendation}</p>
                        </div>
                        <p class="text-xs text-slate-500 mb-3 leading-relaxed">${data.reasoning}</p>
                        <div class="flex flex-wrap gap-1">
                            ${data.risks.map(r => `<span class="px-1.5 py-0.5 rounded bg-red-500/10 text-red-400 text-[9px] border border-red-500/20">${r}</span>`).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.appendChild(card);
            card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function updateTrace(data) {
            document.getElementById('traceJson').textContent = JSON.stringify(data, null, 2);
        }

        function switchTraceTab(tab) {
            document.querySelectorAll('.trace-tab').forEach(t => {
                if (t.dataset.tab === tab) {
                    t.classList.remove('text-slate-500', 'border-transparent');
                    t.classList.add('text-violet-400', 'border-b-2', 'border-violet-400');
                } else {
                    t.classList.add('text-slate-500');
                    t.classList.remove('text-violet-400', 'border-b-2', 'border-violet-400');
                }
            });
            
            // Update trace content based on tab
            const traceContent = document.getElementById('traceContent');
            if (tab === 'planner') {
                traceContent.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-[10px] text-slate-500 font-mono">decisions/2026-02-05/run_0042/agents/planner.json</span>
                        <button class="text-[10px] text-violet-400 hover:text-violet-300">Download</button>
                    </div>
                    <pre class="decision-trace text-slate-400 overflow-x-auto">${JSON.stringify(mockDecision.planner, null, 2)}</pre>
                `;
            } else if (tab === 'specialists') {
                traceContent.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-[10px] text-slate-500 font-mono">decisions/2026-02-05/run_0042/agents/specialists.json</span>
                    </div>
                    <pre class="decision-trace text-slate-400 overflow-x-auto">${JSON.stringify(mockDecision.specialists, null, 2)}</pre>
                `;
            } else if (tab === 'disagreements') {
                traceContent.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-[10px] text-slate-500 font-mono">decisions/2026-02-05/run_0042/disagreement.json</span>
                    </div>
                    <pre class="decision-trace text-slate-400 overflow-x-auto">${JSON.stringify(mockDecision.disagreement, null, 2)}</pre>
                `;
            } else if (tab === 'confidence') {
                traceContent.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-[10px] text-slate-500 font-mono">decisions/2026-02-05/run_0042/termination.json</span>
                    </div>
                    <pre class="decision-trace text-slate-400 overflow-x-auto">${JSON.stringify(mockDecision.termination, null, 2)}</pre>
                `;
            } else {
                traceContent.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-[10px] text-slate-500 font-mono">decisions/2026-02-05/run_0042/trace.json</span>
                        <button class="text-[10px] text-violet-400 hover:text-violet-300 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                            Download
                        </button>
                    </div>
                    <pre class="decision-trace text-slate-400 overflow-x-auto">${JSON.stringify({
                        run_id: "run_0042",
                        timestamp: "2026-02-05T14:33:12Z",
                        prompt: mockDecision.prompt,
                        status: "completed",
                        agents: mockDecision.specialists.map(s => ({ name: s.agent, recommendation: s.recommendation, confidence: s.confidence })),
                        synthesis: { decision: mockDecision.synthesis.final_decision, confidence: mockDecision.synthesis.confidence },
                        termination: mockDecision.termination
                    }, null, 2)}</pre>
                `;
            }
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Auto-focus on load
        window.addEventListener('load', () => {
            document.getElementById('decisionInput').focus();
        });
    </script>
</body>
</html>